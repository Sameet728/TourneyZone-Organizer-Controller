<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Create Tournament | SVx Arena</title>

  <script src="https://cdn.tailwindcss.com"></script>

  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['"Plus Jakarta Sans"', 'sans-serif'],
          },
          colors: {
            brand: {
              50: '#f5f3ff',
              100: '#ede9fe',
              500: '#8b5cf6',
              600: '#7c3aed',
              900: '#4c1d95',
            }
          }
        }
      }
    }
  </script>

  <style>
    /* Smooth Scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #f5f3ff; }
    ::-webkit-scrollbar-thumb { background: #c4b5fd; border-radius: 10px; }

    /* Animations */
    .fade-enter {
      opacity: 0;
      transform: translateY(-10px);
      max-height: 0;
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .fade-enter-active {
      opacity: 1;
      transform: translateY(0);
      max-height: 200px; /* Enough space for the content */
      margin-top: 1.5rem;
    }

    @keyframes blob {
      0% { transform: translate(0px, 0px) scale(1); }
      33% { transform: translate(30px, -50px) scale(1.1); }
      66% { transform: translate(-20px, 20px) scale(0.9); }
      100% { transform: translate(0px, 0px) scale(1); }
    }
    .animate-blob { animation: blob 7s infinite; }
    .animation-delay-2000 { animation-delay: 2s; }
    
    /* Input Styling Class */
    .svx-input {
      width: 100%;
      padding: 0.875rem 1rem;
      background-color: #ffffff;
      border: 1px solid #e2e8f0;
      border-radius: 0.75rem;
      color: #1e293b;
      font-weight: 500;
      transition: all 0.2s;
      outline: none;
    }
    .svx-input:focus {
      border-color: #8b5cf6;
      box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
    }
    .svx-input::placeholder { color: #94a3b8; }
  </style>
</head>

<body class="bg-slate-50 text-slate-800 font-sans min-h-screen flex flex-col relative overflow-x-hidden">

  <div class="fixed top-0 left-0 w-full h-full overflow-hidden -z-10 pointer-events-none">
    <div class="absolute top-0 right-1/4 w-96 h-96 bg-brand-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob"></div>
    <div class="absolute bottom-0 left-1/4 w-96 h-96 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000"></div>
  </div>

  <div class="relative z-50">
    <%- include("../includes/navbar") %>
  </div>

  <div class="container mx-auto px-4 py-8 lg:py-12 flex-grow flex items-center justify-center">
    
    <div class="w-full max-w-4xl relative">
      
      <div class="bg-white/80 backdrop-blur-xl border border-white/60 shadow-2xl rounded-3xl overflow-hidden">
        
        <div class="text-center pt-10 pb-6 px-6">
          <div class="inline-flex items-center justify-center w-16 h-16 bg-brand-50 text-brand-600 rounded-2xl mb-4 shadow-sm text-3xl">
            <i class="fas fa-trophy"></i>
          </div>
          <h2 class="text-3xl font-extrabold text-slate-900 tracking-tight">Create Tournament</h2>
          <p class="text-slate-500 mt-2">Set the stage for the next big battle.</p>
        </div>

        <form action="/organizer/tournaments" method="POST" class="px-8 pb-10 md:px-12 md:pb-12 space-y-8">

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="space-y-1">
              <label class="text-xs font-bold text-slate-500 uppercase ml-1">Tournament Name</label>
              <input name="name" placeholder="e.g. Winter Championship" required class="svx-input">
            </div>
            <div class="space-y-1">
              <label class="text-xs font-bold text-slate-500 uppercase ml-1">Game Title</label>
              <input name="game" placeholder="e.g. Valorant, BGMI" required class="svx-input">
            </div>
            <div class="space-y-1">
              <label class="text-xs font-bold text-slate-500 uppercase ml-1">Entry Fee (‚Çπ)</label>
              <input name="entryFee" type="number" placeholder="0" required class="svx-input">
            </div>
            <div class="space-y-1">
              <label class="text-xs font-bold text-slate-500 uppercase ml-1">Prize Pool (‚Çπ)</label>
              <input name="prizePool" type="number" placeholder="0" class="svx-input">
            </div>
            <div class="space-y-1 md:col-span-2">
              <label class="text-xs font-bold text-slate-500 uppercase ml-1">Total Team Slots</label>
              <input name="teamLimit" type="number" placeholder="e.g. 100" required class="svx-input">
            </div>
          </div>

          <div class="space-y-1">
            <label class="text-xs font-bold text-slate-500 uppercase ml-1">Rules & Description</label>
            <textarea name="description" rows="4" placeholder="Enter tournament rules, map details, and other info..." class="svx-input resize-y"></textarea>
          </div>

          <div class="bg-brand-50/50 p-6 rounded-2xl border border-brand-100 space-y-6">
            <h3 class="text-sm font-bold text-brand-600 uppercase tracking-wider flex items-center gap-2">
              <i class="far fa-calendar-alt"></i> Schedule Settings
            </h3>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              
              <div class="space-y-1">
                <label class="text-xs font-bold text-slate-500 uppercase ml-1">Tournament Date</label>
                <input type="date" name="tournamentDate" required class="svx-input cursor-pointer">
              </div>

              <div class="space-y-1">
                <label class="text-xs font-bold text-slate-500 uppercase ml-1">Registration Closes At</label>
                <div class="flex gap-2">
                  <select id="closeHour" class="svx-input text-center cursor-pointer">
                    <option value="">HH</option>
                    <% for(let i=1;i<=12;i++){ %>
                      <option value="<%= i %>"><%= i %></option>
                    <% } %>
                  </select>
                  <span class="self-center font-bold text-slate-400">:</span>
                  <select id="closeMinute" class="svx-input text-center cursor-pointer">
                    <option value="">MM</option>
                    <option>00</option><option>15</option><option>30</option><option>45</option>
                  </select>
                  <select id="closeMeridian" class="svx-input text-center bg-slate-100 font-bold cursor-pointer">
                    <option>AM</option><option>PM</option>
                  </select>
                </div>
                <input type="hidden" name="registrationCloseTime" id="registrationCloseTime">
              </div>
            </div>
          </div>

          <div class="space-y-4">
            <div class="space-y-1">
              <label class="text-xs font-bold text-slate-500 uppercase ml-1">Tournament Format</label>
              <div class="relative">
                <select name="type" id="type" onchange="toggleScrimTime()" class="svx-input appearance-none cursor-pointer">
                  <option value="regular">üèÜ Regular Tournament</option>
                  <option value="scrim">‚öîÔ∏è Scrim / Practice Match</option>
                </select>
                <div class="absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none text-slate-500">
                  <i class="fas fa-chevron-down text-xs"></i>
                </div>
              </div>
            </div>

            <div id="scrimTimeWrapper" class="fade-enter bg-purple-50 p-6 rounded-2xl border border-purple-100">
              <label class="block text-sm font-bold text-purple-700 mb-3">
                <i class="far fa-clock mr-1"></i> Set Scrim Match Time
              </label>
              <div class="flex gap-2">
                <select id="scrimHour" class="svx-input text-center cursor-pointer border-purple-200 focus:border-purple-500">
                  <option value="">HH</option>
                  <% for(let i=1;i<=12;i++){ %>
                    <option value="<%= i %>"><%= i %></option>
                  <% } %>
                </select>
                <span class="self-center font-bold text-purple-400">:</span>
                <select id="scrimMinute" class="svx-input text-center cursor-pointer border-purple-200 focus:border-purple-500">
                  <option value="">MM</option>
                  <option>00</option><option>15</option><option>30</option><option>45</option>
                </select>
                <select id="scrimMeridian" class="svx-input text-center font-bold cursor-pointer border-purple-200 bg-white text-purple-700">
                  <option>AM</option><option>PM</option>
                </select>
              </div>
              <input type="hidden" name="timeSlot" id="scrimTime">
            </div>
          </div>

          <div class="pt-4">
            <button type="submit" onclick="prepareTimes()"
              class="w-full py-4 px-6 bg-brand-600 text-white font-bold text-lg rounded-xl shadow-xl shadow-brand-500/30 hover:bg-brand-700 hover:shadow-brand-500/50 hover:-translate-y-1 transition-all duration-200 flex items-center justify-center gap-3">
              <span>Launch Tournament</span>
              <i class="fas fa-rocket"></i>
            </button>
          </div>

        </form>
      </div>
    </div>
  </div>

  <div class="mt-auto">
    <%- include("../includes/footer") %>
  </div>

  <script>
    function toggleScrimTime() {
      const type = document.getElementById("type").value;
      const box = document.getElementById("scrimTimeWrapper");
      if (type === "scrim") {
        box.classList.add("fade-enter-active");
      } else {
        box.classList.remove("fade-enter-active");
      }
    }

    function prepareTimes() {
      // 1. Prepare Registration Close Time
      const h = document.getElementById('closeHour').value;
      const m = document.getElementById('closeMinute').value;
      const ap = document.getElementById('closeMeridian').value;
      
      if (h && m) {
        document.getElementById('registrationCloseTime').value = `${h}:${m} ${ap}`;
      }

      // 2. Prepare Scrim Time (if selected)
      const type = document.getElementById("type").value;
      if (type === "scrim") {
        const sh = document.getElementById('scrimHour').value;
        const sm = document.getElementById('scrimMinute').value;
        const sap = document.getElementById('scrimMeridian').value;
        
        if (sh && sm) {
          document.getElementById('scrimTime').value = `${sh}:${sm} ${sap}`;
        }
      }
    }

    // Run on load to handle back-button navigation state
    window.onload = toggleScrimTime;
  </script>

</body>
</html>